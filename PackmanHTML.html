<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="PackmanCSS.css">
        <script type="text/javascript" src="PackmanGenerator.js"></script>
    </head>
    <body>
        <header>
            <h1>Packman Game</h1>
        </header>
        <div class = "group">
           <div class = "left">
               <button class = "Button" id = "start">Start Game</button>
               <br>
               <br>
               <button class = "Button" id = "new">New Game</button>
               <br>
               <br>
               <button class = "Button" id = "pause">Pause Game</button>
           </div>
           <div class = "middle">
                   <table id = "myTable">
                           <tbody id="table">
                              
                           </tbody>
                    </table>
            </div>
        </div>
    </body>
    <script type="text/javascript">
        let newGame = document.getElementById("new");
        let table = document.getElementById("myTable");
        let start = document.getElementById("start");
        let k,k2,r,c;
        window.addEventListener('load',(event)=>{
           k = generatePackman();
           r = 7;
           c = 20; 
           let row;
           for(let i=0;i<15;i++){
                row = "<tr>";
                for(let j=40;j>=0;j--){
                    if(k[i][j]==1){
                        row += `<td><img src="${"pictures\\coin.png"}" alt="coin"></td>`;
                    }
                    else if(k[i][j]==2){
                        row += `<td><img src="${"pictures\\brick.png"}" alt="brick"></td>`;
                    }
                    else if(k[i][j]==3){
                        row += `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`;
                    }
                    else{
                        row += `<td><img src="${"pictures\\ghost.png"}" alt="ghost"></td>`;
                    }
                }
                row += "</tr>"        
                table.innerHTML += row;
           }
        });
        newGame.addEventListener('click',(event)=>{
            table.innerHTML = '';
            k = generatePackman();
            r = 7;
            c = 20; 
            for(let i=0;i<15;i++){
                 row = "<tr>";
                 for(let j=0;j<41;j++){
                     if(k[i][j]==1){
                         row += `<td><img src="${"pictures\\coin.png"}" alt="coin"></td>`;
                     }
                     else if(k[i][j]==2){
                         row += `<td><img src="${"pictures\\brick.png"}" alt="brick"></td>`;
                     }
                     else if(k[i][j]==3){
                         row += `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`;
                     }
                     else{
                         row += `<td><img src="${"pictures\\ghost.png"}" alt="ghost"></td>`;
                     }
                 }
                 row += "</tr>"        
                 table.innerHTML += row;
            }
         });
         start.addEventListener('click',(event)=>{
               let list = document.getElementsByTagName("td");
               let dc,dr,dummy;
               document.addEventListener("keydown",(event)=>{
                    if(event.keyCode == 37){
                        dc = c;
                        c = c + 1;
                        if(k[r][c]==4){
                            alert("Game over");
                        }
                        else if(k[r][c]!=2){
                            dummy = ((r+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`;
                            dummy = ((r+1)*41)-(dc+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\bg.png"}" alt="bg"></td>`;
                            k[r][c] = 5;
                        }
                        else{
                            c=dc;
                        }
                    }
                    else if(event.keyCode==38){
                        dr = r;
                        r = r - 1;
                        if(k[r][c]==4){
                            alert("Game over");
                        }
                        else if(k[r][c]!=2){
                            dummy = ((r+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`; 
                            dummy = ((dr+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\bg.png"}" alt="bg"></td>`;
                            k[r][c] = 5;
                        }
                        else{
                            r = dr;
                        }
                    }
                    else if(event.keyCode==39){
                        dc = c;
                        c = c - 1;
                        if(k[r][c]==4){
                            alert("Game over");
                        }
                        else if(k[r][c]!=2){
                            dummy = ((r+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`;
                            dummy = ((r+1)*41)-(dc+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\bg.png"}" alt="bg"></td>`;
                            k[r][c] = 5;
                        }
                        else{
                            c = dc;
                        }
                    }
                    else if(event.keyCode==40){
                        dr = r;
                        r = r + 1;
                        if(k[r][c]==4){
                            alert("Game over");
                        }
                        else if(k[r][c]!=2){
                            dummy = ((r+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\pacman.png"}" alt="pacman"></td>`;  
                            dummy = ((dr+1)*41)-(c+1);
                            list[dummy].innerHTML = `<td><img src="${"pictures\\bg.png"}" alt="bg"></td>`; 
                            k[r][c] = 5;
                        }
                        else{
                            r = dr;
                        }
                    }
               });
         });
    </script>
</html>